<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <!-- Unified Temperature Graph Overlay -->
  <!-- Shows all temperature sensors with toggle chips and optional heater controls -->
  <view name="temp_graph_overlay" extends="overlay_panel" title="Temperature" title_tag="Temperature">
    <!-- Content area: graph+chips left, controls right (side-by-side) -->
    <lv_obj name="overlay_content"
            width="100%" flex_grow="1"
            style_pad_all="#space_lg"
            scrollable="false" style_border_opa="0"
            flex_flow="row" style_flex_main_place="space_between">
      <!-- Disable content when printer not connected or klippy not ready -->
      <bind_state_if_not_eq subject="nav_buttons_enabled" state="disabled" ref_value="1"/>

      <!-- Left column: Chip row + Temperature Graph -->
      <lv_obj name="graph_outer_container"
              width="66%" height="100%"
              style_pad_all="0" scrollable="false" style_border_opa="0"
              flex_flow="column" style_pad_gap="0">
        <!-- Chip row: wrapping series toggle chips -->
        <lv_obj name="chip_row"
                width="100%" height="content"
                style_pad_all="0" style_pad_bottom="#space_xs"
                style_border_opa="0" scrollable="false"
                flex_flow="row_wrap" style_pad_gap="#space_xs"
                style_flex_cross_place="center">
          <!-- Chips populated programmatically in C++ -->
        </lv_obj>
        <!-- Graph fills remaining space -->
        <lv_obj name="graph_container" width="100%" flex_grow="1"
                style_pad_all="0" scrollable="false" style_border_opa="0">
          <!-- Temperature graph created programmatically in C++ -->
        </lv_obj>
      </lv_obj>

      <!-- ════════════════════════════════════════════════════════════════ -->
      <!-- Right Column: NOZZLE controls (shown in nozzle mode only)      -->
      <!-- ════════════════════════════════════════════════════════════════ -->
      <lv_obj name="nozzle_control_strip"
              width="33%" height="100%" style_pad_all="0" scrollable="false" style_border_opa="0"
              flex_flow="column" style_flex_main_place="start" style_flex_cross_place="center"
              style_pad_gap="#space_sm" flag_hidden="true">
        <!-- Current/Target Temperature Display Card with Icon and Status -->
        <ui_card name="nozzle_display_card"
                 width="100%" height="content" style_radius="0" flex_flow="column"
                 style_flex_main_place="center" style_pad_gap="#space_xs" style_pad_all="#space_sm">
          <lv_obj width="100%" flex_flow="row" style_pad_all="0" scrollable="false">
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
            <lv_obj height="content" flex_flow="column" style_flex_cross_place="start"
                    style_pad_all="0" style_pad_gap="#space_xs" scrollable="false">
              <nozzle_icon name="nozzle_heater_icon" size="xl"/>
              <lv_obj style_pad_all="0" scrollable="false" flex_flow="column"
                      style_flex_main_place="center" style_flex_cross_place="start"
                      style_pad_gap="#space_xxs">
                <text_small style_border_width="0" text="Current / Target" translation_tag="Current / Target"/>
                <temp_display name="nozzle_temp_display"
                              size="lg" show_target="true" bind_current="extruder_temp" bind_target="extruder_target"/>
              </lv_obj>
              <text_small name="nozzle_status_msg" style_border_width="0"
                          bind_text="nozzle_status" style_text_align="left"/>
            </lv_obj>
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
          </lv_obj>
        </ui_card>
        <!-- Extruder selector (shown when multiple extruders detected) -->
        <lv_obj name="extruder_selector_row"
                width="100%" height="content"
                style_pad_all="0" scrollable="false" style_border_opa="0"
                flex_flow="row" style_pad_gap="#space_xs" style_flex_main_place="center"
                flag_hidden="true">
          <!-- Populated programmatically in C++ -->
        </lv_obj>
        <!-- Spacer -->
        <lv_obj width="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
        <!-- Preset buttons -->
        <lv_obj name="nozzle_preset_grid"
                width="100%" height="content" style_pad_all="0" scrollable="false"
                flex_flow="row_wrap" style_flex_main_place="space_between" style_pad_gap="#space_xs">
          <ui_button name="preset_off" width="48%" text="Off" translation_tag="Off"
                     variant="ghost" style_border_width="#border_width"
                     style_border_color="#border" style_border_opa="255">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="preset_1" width="48%" text="PLA" translation_tag="PLA">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="preset_2" width="48%" text="PETG" translation_tag="PETG">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="preset_3" width="48%" text="ABS" translation_tag="ABS">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
        </lv_obj>
        <ui_button name="nozzle_btn_custom" width="100%" text="Custom..." translation_tag="Custom..." variant="secondary">
          <event_cb trigger="clicked" callback="on_temp_graph_custom_clicked"/>
        </ui_button>
      </lv_obj>

      <!-- ════════════════════════════════════════════════════════════════ -->
      <!-- Right Column: BED controls (shown in bed mode only)            -->
      <!-- ════════════════════════════════════════════════════════════════ -->
      <lv_obj name="bed_control_strip"
              width="33%" height="100%" style_pad_all="0" scrollable="false" style_border_opa="0"
              flex_flow="column" style_flex_main_place="start" style_flex_cross_place="center"
              style_pad_gap="#space_sm" flag_hidden="true">
        <ui_card name="bed_display_card"
                 width="100%" height="content" style_radius="0" flex_flow="column"
                 style_flex_main_place="center" style_pad_gap="#space_xs" style_pad_all="#space_sm">
          <lv_obj width="100%" flex_flow="row" style_pad_all="0" scrollable="false">
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
            <lv_obj height="content" flex_flow="column" style_flex_cross_place="start"
                    style_pad_all="0" style_pad_gap="#space_xs" scrollable="false">
              <icon name="bed_icon" src="radiator" size="xl" variant="secondary"/>
              <lv_obj style_pad_all="0" scrollable="false" flex_flow="column"
                      style_flex_main_place="center" style_flex_cross_place="start"
                      style_pad_gap="#space_xxs">
                <text_small text="Current / Target" translation_tag="Current / Target"/>
                <temp_display name="bed_temp_display"
                              size="lg" show_target="true" bind_current="bed_temp" bind_target="bed_target"/>
              </lv_obj>
              <text_small name="bed_status_msg" bind_text="bed_status" style_text_align="left"/>
            </lv_obj>
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
          </lv_obj>
        </ui_card>
        <lv_obj width="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
        <lv_obj name="bed_preset_grid"
                width="100%" height="content" style_pad_all="0" scrollable="false"
                flex_flow="row_wrap" style_flex_main_place="space_between" style_pad_gap="#space_xs">
          <ui_button name="bed_preset_off" width="48%" text="Off" translation_tag="Off"
                     variant="ghost" style_border_width="#border_width"
                     style_border_color="#border" style_border_opa="255">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="bed_preset_1" width="48%" text="PLA" translation_tag="PLA">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="bed_preset_2" width="48%" text="PETG" translation_tag="PETG">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="bed_preset_3" width="48%" text="ABS" translation_tag="ABS">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
        </lv_obj>
        <ui_button name="bed_btn_custom" width="100%" text="Custom..." translation_tag="Custom..." variant="secondary">
          <event_cb trigger="clicked" callback="on_temp_graph_custom_clicked"/>
        </ui_button>
      </lv_obj>

      <!-- ════════════════════════════════════════════════════════════════ -->
      <!-- Right Column: CHAMBER controls (shown in chamber mode only)    -->
      <!-- ════════════════════════════════════════════════════════════════ -->
      <lv_obj name="chamber_control_strip"
              width="33%" height="100%" style_pad_all="0" scrollable="false" style_border_opa="0"
              flex_flow="column" style_flex_main_place="start" style_flex_cross_place="center"
              style_pad_gap="#space_sm" flag_hidden="true">
        <ui_card name="chamber_display_card"
                 width="100%" height="content" style_radius="0" flex_flow="column"
                 style_flex_main_place="center" style_pad_gap="#space_xs" style_pad_all="#space_sm">
          <lv_obj width="100%" flex_flow="row" style_pad_all="0" scrollable="false">
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
            <lv_obj height="content" flex_flow="column" style_flex_cross_place="start"
                    style_pad_all="0" style_pad_gap="#space_xs" scrollable="false">
              <icon name="chamber_icon" src="fridge_industrial" size="xl" variant="secondary"/>
              <lv_obj style_pad_all="0" scrollable="false" flex_flow="column"
                      style_flex_main_place="center" style_flex_cross_place="start"
                      style_pad_gap="#space_xxs">
                <text_small text="Current / Target" translation_tag="Current / Target"/>
                <temp_display name="chamber_temp_display"
                              size="lg" show_target="true" bind_current="chamber_temp" bind_target="chamber_target"/>
              </lv_obj>
              <text_small name="chamber_status_msg" bind_text="chamber_status" style_text_align="left"/>
            </lv_obj>
            <lv_obj height="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
          </lv_obj>
        </ui_card>
        <lv_obj width="1" flex_grow="1" style_pad_all="0" scrollable="false"/>
        <!-- Preset buttons: hidden when chamber is sensor-only -->
        <lv_obj name="chamber_preset_grid"
                width="100%" height="content" style_pad_all="0" scrollable="false"
                flex_flow="row_wrap" style_flex_main_place="space_between" style_pad_gap="#space_xs">
          <bind_flag_if_eq subject="printer_has_chamber_heater" flag="hidden" ref_value="0"/>
          <ui_button name="chamber_preset_off" width="48%" text="Off" translation_tag="Off"
                     variant="ghost" style_border_width="#border_width"
                     style_border_color="#border" style_border_opa="255">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="chamber_preset_1" width="48%" text="PLA" translation_tag="PLA">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="chamber_preset_2" width="48%" text="PETG" translation_tag="PETG">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
          <ui_button name="chamber_preset_3" width="48%" text="ABS" translation_tag="ABS">
            <event_cb trigger="clicked" callback="on_temp_graph_preset_clicked"/>
          </ui_button>
        </lv_obj>
        <ui_button name="chamber_btn_custom" width="100%" text="Custom..." translation_tag="Custom..." variant="secondary">
          <bind_flag_if_eq subject="printer_has_chamber_heater" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="on_temp_graph_custom_clicked"/>
        </ui_button>
      </lv_obj>

    </lv_obj>
  </view>
</component>
